---
- name: Create NFS-PV Templates
  template:
    src: nfs-pv.yml
    dest: /tmp/nfs-pv-{{ item.name }}.yml
  with_items: "{{ nfs_volumes }}"
  when: "'controlhost' in group_names"

- name: Execute NFS-PV Templates
  shell: oc create -f /tmp/nfs-pv-{{ item.name }}.yml
  with_items: "{{ nfs_volumes }}"
  when: "'controlhost' in group_names"

- name: Remove NFS-PV Templates
  file:
    path: /tmp/nfs-pv-{{ item.name }}.yml
    state: absent
  with_items: "{{ nfs_volumes }}"
  when: "'controlhost' in group_names"
